# Security Scanner Environment Configuration
# Copy this file to .env and adjust values as needed

# ============================================================================
# PARALLEL SCANNING
# ============================================================================
# Enable/disable parallel scanning (default: true)
SCANNER_PARALLEL_ENABLED=true

# Number of worker threads for parallel scanning (default: CPU count, max 8)
SCANNER_PARALLEL_WORKERS=8

# Minimum number of files before using parallel mode (default: 10)
SCANNER_PARALLEL_THRESHOLD=10

# ============================================================================
# CACHING
# ============================================================================
# Enable/disable file caching (default: true)
SCANNER_CACHE_ENABLED=true

# Cache expiration time in milliseconds (default: 604800000 = 7 days)
SCANNER_CACHE_MAX_AGE=604800000

# Maximum number of cache entries (default: 10000)
SCANNER_CACHE_MAX_ENTRIES=10000

# Maximum cache size in MB (default: 100)
SCANNER_CACHE_MAX_SIZE_MB=100

# Custom cache directory (optional, defaults to system cache dir)
# SCANNER_CACHE_DIR=/path/to/cache

# ============================================================================
# STORAGE
# ============================================================================
# Storage backend: "json" or "sqlite" (default: json)
SCANNER_STORAGE_BACKEND=json

# Custom SQLite database path (optional)
# SCANNER_SQLITE_PATH=/path/to/scans.db

# Maximum number of stored scans (default: 100 for JSON, 1000 for SQLite)
SCANNER_MAX_STORED_SCANS=100

# ============================================================================
# PERFORMANCE & FILE LIMITS
# ============================================================================
# Maximum file size to scan in bytes (default: 5242880 = 5MB)
SCANNER_MAX_FILE_SIZE=5242880

# Enable streaming for large files (default: false)
SCANNER_STREAMING_ENABLED=false

# File size threshold for streaming in bytes (default: 1048576 = 1MB)
SCANNER_STREAMING_THRESHOLD=1048576

# ============================================================================
# SAFETY LIMITS (Prevent Memory Exhaustion)
# ============================================================================
# Maximum total findings across all files (default: 10000)
SCANNER_MAX_TOTAL_FINDINGS=10000

# Maximum findings per file (default: 100)
SCANNER_MAX_FINDINGS_PER_FILE=100

# Regex execution timeout in milliseconds (default: 1000 = 1 second)
SCANNER_REGEX_TIMEOUT_MS=1000

# ============================================================================
# MCP (Model Context Protocol) CONFIGURATION
# ============================================================================
# Maximum retry attempts for MCP calls (default: 3)
SCANNER_MCP_MAX_RETRIES=3

# Base delay between retries in milliseconds (default: 1000 = 1 second)
# Uses exponential backoff: 1s, 2s, 4s, etc.
SCANNER_MCP_RETRY_DELAY_MS=1000

# Timeout for MCP requests in milliseconds (default: 30000 = 30 seconds)
SCANNER_MCP_TIMEOUT_MS=30000